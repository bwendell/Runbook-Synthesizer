# Runbook-Synthesizer Configuration
# Helidon SE 4.x Configuration

server:
  port: 8080
  host: 0.0.0.0

# Health and Observability
server.features:
  observe:
    observers:
      health:
        enabled: true

# Logging Configuration
logging:
  level: INFO

# --------------------------------------------------------
# Cloud Provider Configuration
# --------------------------------------------------------
# Selects which cloud provider's adapters to use for storage,
# compute metadata, metrics, and logging operations.

cloud:
  provider: aws # 'aws' (default) or 'oci'

  # AWS Configuration (used when provider: aws)
  aws:
    region: ${AWS_REGION:us-west-2}
    storage:
      bucket: ${AWS_S3_BUCKET:runbook-synthesizer-runbooks}
    # Uses AWS default credential chain:
    # 1. Environment variables (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)
    # 2. AWS credentials file (~/.aws/credentials)
    # 3. ECS container credentials
    # 4. EC2 instance profile / IAM role
    # 5. Web identity token (EKS IRSA)

# --------------------------------------------------------
# LLM Provider Configuration
# --------------------------------------------------------
# Configures which LLM provider to use for text generation and embeddings.
# Supports 'ollama' (MVP/local development) and 'aws-bedrock' (production).

llm:
  # LLM provider: 'ollama' (MVP default) or 'aws-bedrock' (production)
  provider: ${LLM_PROVIDER:ollama}

  # Ollama Configuration (MVP/Local Development)
  # Run 'ollama serve' and pull required models before use
  ollama:
    baseUrl: ${OLLAMA_BASE_URL:http://localhost:11434}
    textModel: ${OLLAMA_TEXT_MODEL:llama3.2:3b}
    embeddingModel: ${OLLAMA_EMBEDDING_MODEL:nomic-embed-text}

  # AWS Bedrock Configuration (Production)
  # Requires AWS credentials with bedrock:InvokeModel permission
  aws-bedrock:
    region: ${AWS_BEDROCK_REGION:us-west-2}
    textModelId: ${AWS_BEDROCK_TEXT_MODEL:anthropic.claude-3-haiku-20240307-v1:0}
    embeddingModelId: ${AWS_BEDROCK_EMBEDDING_MODEL:cohere.embed-english-v3}

# --------------------------------------------------------
# OCI Configuration (Alternative Provider)
# --------------------------------------------------------
# Uncomment and configure for OCI deployment

# oci:
#   tenancy: ${OCI_TENANCY_OCID}
#   user: ${OCI_USER_OCID}
#   region: ${OCI_REGION}
#   fingerprint: ${OCI_FINGERPRINT}
#   keyFile: ${OCI_KEY_FILE}

# Output Webhooks Configuration
output:
  webhooks:
    # Example Generic Webhook (disabled by default)
    - name: example-generic
      type: generic
      url: ${WEBHOOK_URL:http://localhost:8888/webhook}
      enabled: false
      headers:
        Authorization: Bearer ${WEBHOOK_TOKEN:example-token}

    # Slack Webhook (v1.1 - stub only)
    # - name: slack-oncall
    #   type: slack
    #   url: ${SLACK_WEBHOOK_URL}
    #   enabled: true
    #   filter:
    #     severities: [CRITICAL, WARNING]

    # PagerDuty (v1.1 - stub only)
    # - name: pagerduty-incidents
    #   type: pagerduty
    #   url: https://events.pagerduty.com/v2/enqueue
    #   enabled: true
    #   headers:
    #     X-Routing-Key: ${PD_ROUTING_KEY}
    #   filter:
    #     severities: [CRITICAL]

  # --------------------------------------------------------
  # File Output Configuration
  # --------------------------------------------------------
  # Writes generated checklists as JSON files to local directory.
  # Useful for MVP validation and local testing.
  file:
    enabled: ${FILE_OUTPUT_ENABLED:true}
    outputDirectory: ${FILE_OUTPUT_DIR:./output}
    name: file-output
